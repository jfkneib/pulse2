<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
"http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">
<article class="whitepaper">
  <title>Pulse 2 Scheduler configuration file</title>

  <articleinfo>
    <author>
      <firstname>Nicolas</firstname>

      <surname>Rueff</surname>

      <email>nrueff@mandriva.com</email>
    </author>

    <affiliation>
      <orgname>Mandriva</orgname>
    </affiliation>

    <copyright>
      <year>2008 Nicolas Rueff - Mandriva</year>
    </copyright>

    <revhistory>
      <revision>
        <revnumber>$Revision$</revnumber>

        <date>$Date$</date>

        <authorinitials>$Author$</authorinitials>
      </revision>
    </revhistory>

    <abstract>
      <para>This document explains the content of the configuration file of
      the scheduler service from Pulse 2</para>
    </abstract>
  </articleinfo>

  <section>
    <title>Introduction</title>

    <para>The « Scheduler » service is the Pulse 2 daemon in charge of reading
    the MSC database, dispatching commands over available launchers and
    writing results in the MSC database.</para>

    <para>The service configuration file is
    <filename>/etc/mmc/pulse2/scheduler.ini</filename>.</para>

    <para>Like all Pulse 2 related configuration file, its file format is INI
    style. The file is made of sections, each one starting with a
    « [sectionname] » header. In each section options can be defined like
    this: « option = value ».</para>

    <para>For example: <screen>[section1]
option1 = 1
option2 = 2

[section2]
option1 = foo
option2 = plop      </screen></para>
  </section>

  <section>
    <title>Configuration file sections</title>

    <para>For now only section is available in this configuration file. Some
    sections describing the different available launchers may appear, their
    name must begin with "launcher_".</para>

    <table>
      <title>scheduler.ini available sections</title>

      <tgroup cols="3">
        <thead>
          <row>
            <entry>Section name</entry>

            <entry>Description</entry>

            <entry>Optional</entry>
          </row>
        </thead>

        <tbody>
          <row>
            <entry>scheduler</entry>

            <entry>Mostly scheduler related behaviors</entry>

            <entry>no</entry>
          </row>

          <row>
            <entry>launcher_XXX</entry>

            <entry>A way to talk to launcher_XXX</entry>

            <entry>yes</entry>
          </row>
        </tbody>
      </tgroup>
    </table>

    <para>All the other sections (loggers, handlers, ...) are related to
    Python language logging framework. See <ulink
    url="http://docs.python.org/lib/logging-config-fileformat.html">http://docs.python.org/lib/logging-config-fileformat.html</ulink>
    .</para>
  </section>

  <section>
    <title>« scheduler » section</title>

    <para>This section is used to give directives to the scheduler
    service.</para>

    <table>
      <title>Available options for the "main" section</title>

      <tgroup cols="4">
        <thead>
          <row>
            <entry>Option name</entry>

            <entry>Description</entry>

            <entry>Optional</entry>

            <entry>Default value</entry>
          </row>
        </thead>

        <tbody>
          <row>
            <entry>id</entry>

            <entry>This scheduler name, used to take the right jobs in the
            database.</entry>

            <entry>no</entry>

            <entry></entry>
          </row>

          <row>
            <entry>scheduler_path</entry>

            <entry>The Scheduler main script location, used by
            scheduler-manager to start and daemonize the service.</entry>

            <entry>no</entry>

            <entry></entry>
          </row>

          <row>
            <entry>pid_path</entry>

            <entry>The Scheduler service PID, used by scheduler-manager to
            track the scheduler service.</entry>

            <entry>no</entry>

            <entry></entry>
          </row>

          <row>
            <entry>port</entry>

            <entry>This scheduler listing TCP port.</entry>

            <entry>yes</entry>

            <entry>8000</entry>
          </row>

          <row>
            <entry>listen</entry>

            <entry>This scheduler listing binding IP address.</entry>

            <entry>yes</entry>

            <entry>127.0.0.1</entry>
          </row>

          <row>
            <entry>enablessl</entry>

            <entry>SSL mode support</entry>

            <entry>yes</entry>

            <entry>1</entry>
          </row>

          <row>
            <entry>certfile</entry>

            <entry>path to the certificate file describing the certificate authority of the SSL server</entry>

            <entry>yes</entry>

            <entry>/etc/mmc/pulse2/scheduler/keys/cacert.pem</entry>
          </row>

          <row>
            <entry>privkey</entry>

            <entry>path to the SSL serverprivate certificate</entry>

            <entry>yes</entry>

            <entry>/etc/mmc/pulse2/scheduler/keys/privkey.pem</entry>
          </row>

          <row>
            <entry>username</entry>

            <entry>The name to use when sending XMLRPC commands to this
            scheduler.</entry>

            <entry>yes</entry>

            <entry>username</entry>
          </row>

          <row>
            <entry>password</entry>

            <entry>The password to use when sending XMLRPC commands to this
            scheduler.</entry>

            <entry>yes</entry>

            <entry>password</entry>
          </row>

          <row>
            <entry>awake_time</entry>

            <entry>The scheduler will periodicaly awake (for exemple to poll
            the database), with this key a specific periodicity can be given.
            Field unit is the "second".</entry>

            <entry>yes</entry>

            <entry>600 (ie 10 minuts)</entry>
          </row>

          <row>
            <entry>dbencoding</entry>

            <entry>The encodig to use when injecting logs into the MSC
            database.</entry>

            <entry>yes</entry>

            <entry>utf-8</entry>
          </row>

          <row>
            <entry>mode</entry>

            <entry>The scheduler way-of-giving-task-to-its-launchers (see
            doc).</entry>

            <entry>yes</entry>

            <entry>sync</entry>
          </row>

          <row>
            <entry>prober_path</entry>

            <entry>Pulse 2 scheduler prober (ie "os resolver")
            location.</entry>

            <entry>yes</entry>

            <entry>/usr/local/sbin/pulse2-probe</entry>
          </row>

          <row>
            <entry>ping_path</entry>

            <entry>Pulse 2 scheduler pinger (ie "client finger")
            location.</entry>

            <entry>yes</entry>

            <entry>/usr/local/sbin/pulse2-ping</entry>
          </row>

          <row>
            <entry>wol_path</entry>

            <entry>Pulse 2 scheduler awaker (via WOL "magic packet").</entry>

            <entry>yes</entry>

            <entry>/usr/local/sbin/pulse2-wol</entry>
          </row>

          <row>
            <entry>wol_port</entry>

            <entry>WOL TCP port.</entry>

            <entry>yes</entry>

            <entry>40000</entry>
          </row>

          <row>
            <entry>wol_bcast</entry>

            <entry>WOL IP BCast adress.</entry>

            <entry>yes</entry>

            <entry>255.255.255.255</entry>
          </row>

          <row>
            <entry>resolv_order</entry>

            <entry>The different means used to find a client on the network
            (see doc).</entry>

            <entry>yes</entry>

            <entry>fqdn hosts netbios ip</entry>
          </row>
        </tbody>
      </tgroup>
    </table>
  </section>

  <section>
    <title>« launcher_XXX » section</title>

    <para>This section define available launchers (one per launcher, "XXX"
    must be an integer).</para>

    <table>
      <title>Available options for the "launcher_XXX" section</title>

      <tgroup cols="4">
        <thead>
          <row>
            <entry>Option name</entry>

            <entry>Description</entry>

            <entry>Optional</entry>

            <entry>Default value</entry>
          </row>
        </thead>

        <tbody>
          <row>
            <entry>host</entry>

            <entry>The launcher IP address.</entry>

            <entry>yes</entry>

            <entry>127.0.0.1</entry>
          </row>

          <row>
            <entry>port</entry>

            <entry>The launcher TCP port.</entry>
	    
            <entry>yes</entry>

            <entry>8001</entry>
          </row>

          <row>
            <entry>enablessl</entry>

            <entry>Flag telling if SSL mode should be used to connect to the launcher.</entry>
	    
            <entry>yes</entry>

            <entry>1</entry>
          </row>

          <row>
            <entry>username</entry>

            <entry>The name to use when we send XMLRPC commands to this
            launcher.</entry>

            <entry>yes</entry>

            <entry>username</entry>
          </row>

          <row>
            <entry>password</entry>

            <entry>The password to use when we send XMLRPC commands to this
            launcher.</entry>

            <entry>yes</entry>

            <entry>password</entry>
          </row>
        </tbody>
      </tgroup>
    </table>

    <para>By default, a launcher is always defined: "launcher_01":</para>

    <screen>
[launcher_01]
host=127.0.0.1
port=8001
username = username
password = password
enablessl = 1
    </screen>
  </section>
</article>